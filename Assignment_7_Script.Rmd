---
title: "Assignment_7_Script"
author: "Hayden Simm"
date: "2026-02-24"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Hypothesis: At the level of whole-body metabolism, differences in aerobic scope between acclimation treatments are expected because of the energetic costs of acclimation. I hypothesize that cold (10 ℃) acclimated fish will have greater aerobic scope than warm (24 ℃) acclimated counterparts because of increased metabolic capacity to overcome the dampening effect of temperature on ectotherm metabolism. However, I predict that simultaneous acclimation to hyperosmotic (28 ppt) salinity will constrain the temperature acclimation response because of a co-reliance on thyroid signalling. Therefore, cold and isomotic (11 ppt) acclimated fish are predicted to have greater than aerobic scope than fish acclimated to either hyperosmotic and warm conditions. 

```{r}
# loading packages --------------------------------------------------------
suppressPackageStartupMessages({
  library(tidyverse)
  library(emmeans)
  library(ggplot2)
  library(car)
  library(see)
  library(performance)
  library(broom)
})
```

Creating dataframe
```{r}
df_respirometry<-read_csv("combined_respirometry_data.csv")
```

Converting predictor variables to factors
```{r}
df_respirometry <- df_respirometry %>%
  mutate(across(c(acclimation_salinity,
                  acclimation_temperature),
                as.factor))
```

glm
```{r}
glmodel<-glm(aerobic_scope_24deg ~ acclimation_salinity * acclimation_temperature,
  data = df_respirometry,
  family = gaussian
)
```

Diagnostic plots
```{r}
plot(glmodel, which = 1)
plot(glmodel, which = 3)
```
Residuals vs fitted: The data points are clustering into 4 columns associated with the 4 treatment combinations however this is expected because of the categorical nature of the predictors. As well, the residuals across these columns are centered around 0 so the assumption of linearity looks met. However, heteroscedasicity appears to be mildly present as variance in residuals is increasing with predicted value.
Scale-Location: To further test the presence of heteroscedasicity we see a slightly increasing trend with increasing fitted values. To combat this issue I am justifying attempting a log transformation.

log tranformation
```{r}
log_glmodel<-glm(log(aerobic_scope_24deg) ~ acclimation_salinity * acclimation_temperature,
    data = df_respirometry,
    family = gaussian)
```

Transformed diagnostic plots
```{r}
plot(log_glmodel, which = 1)
plot(log_glmodel, which = 3)
```
This seems to do a good job at addressing the differences in variance across the predicted values. The residuals vs fitted does not look to fan to one end and the scale-location looks more horizontal. Therefore, I am going to proceed with the log transformed model.

Inferential plot
```{r}
coef_df <- tidy(log_glmodel, conf.int = TRUE)

ggplot(coef_df[-1, ], aes(x = estimate, y = term)) +  # remove intercept
  geom_point() +
  geom_errorbarh(aes(xmin = conf.low, xmax = conf.high), width = 0.2) +
  geom_vline(xintercept = 0, linetype = "dashed") +
  labs(x = "Estimate ± 95% CI", y = "") +
  theme_minimal(base_size = 14)

coef(log_glmodel)
```
There is no statistically clear effect where of both acclimation treatments and the interaction between them have confidence intervals that cross 0. The mean estimate of acclimation_temperature24 and acclimation_salinity28 model terms being negative aligns with my hypothesis because I am predicting reduced aerobic scope compared to cold and isosmotic acclimation respectively. Interestingly, the mean of the interaction is on the opposite side of the 0 line to the factors alone. This continues to suggest that a biologically relevant interaction may exist, but its statistical significance remains unclear. The x-axis of this graph represent the estimated regression coefficients for each model term. Since the model is log transformed they represent e^(coeffecient). This is important to understand the magnitude of the effects of the model terms. Since aerobic scope captures the amount of energy available for performance beyond rest, it is extremely ecologically relevant. Fundulus are a very abundant species in Atlantic coastal estuaries (Burnett et al., 2007), and so even a 5% reduction in metabolic capacity (aerobic scope) would have significant population wide and individual effects on energy expenditure for feeding, evade predation and reproduction. So somewhat arbitrarily, I would suggest that a value of ~0.05 on the x-axis would be a biological significant effect size. Therefore, again the interaction is statistically unclear, but a magnitude of ~0.11 suggests further experimental testing, potentially by increasing the severity of the environmental treatments to see if the individual and interaction terms becomes more clear. 

